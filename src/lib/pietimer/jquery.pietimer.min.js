(function(e){"use strict";var t=360,n={seconds:10,color:"rgba(0, 0, 0, 0.2)",sliceColor:"rgba(255, 255, 255, 0.2)",height:null,width:null,start:360},r=40,i="pie_timer",s="pie_timer",o=3*Math.PI/2,u=Math.PI/180,a=function(e,t,n){t.width===null&&(t.width=e.width()),t.height===null&&(t.height=e.height()),this.settings=t,this.jquery_object=e,this.interval_id=null,this.current_value=this.settings.start,this.callback=n,this.is_paused=!0,this.jquery_object.html('<canvas class="'+i+'" width="'+t.width+'" height="'+t.height+'"></canvas>'),this.canvas=this.jquery_object.children("."+i)[0]};a.prototype={start:function(){this.is_paused&&(this.current_value<=0&&(this.current_value=this.settings.start),this.interval_id=setInterval(e.proxy(this.run_timer,this),r),this.is_paused=!1)},pause:function(){this.is_paused||(clearInterval(this.interval_id),this.is_paused=!0)},run_timer:function(){if(this.canvas.getContext){this.canvas.width=this.settings.width,this.canvas.width=this.settings.width;var t=this.canvas.getContext("2d"),n=[this.canvas.width,this.canvas.height],r=Math.min(n[0],n[1])/2,i=[n[0]/2,n[1]/2];t.beginPath(),t.arc(i[0],i[1],r,0,Math.PI*2,!0),t.closePath(),t.fillStyle=this.settings.color,t.fill(),this.current_value-=this.settings.start/this.settings.seconds/24;if(this.current_value<=0)clearInterval(this.interval_id),e.isFunction(this.callback)&&this.callback.call(),this.is_paused=!0;else{t.beginPath(),t.moveTo(i[0],i[1]);var s=o;t.arc(i[0],i[1],r,s,s+this.current_value*u,!1),t.fillStyle=this.settings.sliceColor,t.fill(),t.closePath()}}}};var f=function(t,r){var i=e.extend({},n,t);return this.each(function(){var t=e(this),n=new a(t,i,r);t.data(s,n)})},l=function(t){t in a.prototype||e.error("Method "+t+" does not exist on jQuery.pietimer");var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e(this),i=r.data(s);if(!i)return!0;i[t].apply(i,n)})};e.fn.pietimer=function(e){return typeof e=="object"||!e?f.apply(this,arguments):l.apply(this,arguments)}})(jQuery)